<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Live SOL Deposits</title>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <style>
    body {
      background-color: #0c0c0c;
      color: #00ff66;
      font-family: monospace;
      padding: 24px;
    }
    .entry {
      background: #111;
      border: 1px solid #333;
      border-radius: 6px;
      padding: 12px 16px;
      margin-bottom: 8px;
      color: #ccc;
    }
    .entry span {
      color: #b084f7;
    }
  </style>
</head>
<body>
  <h3>ðŸŒ• Live Deposits</h3>
  <div id="deposits">
    <p>Waiting for deposits...</p>
  </div>

  <script>
    const socket = io("https://sol-deposit-tracker-production.up.railway.app");
    const container = document.getElementById("deposits");

    const render = (deposits) => {
      container.innerHTML = "";
      deposits.forEach(d => {
        const div = document.createElement("div");
        div.className = "entry";
        div.innerHTML = `ðŸ’¸ <span>${d.amount} SOL</span> received<br><a href="https://solscan.io/tx/${d.signature}" target="_blank">${d.signature.slice(0, 32)}...</a>`;
        container.appendChild(div);
      });
    };

    socket.on("history", render);

    socket.on("newDeposit", (newOnes) => {
      console.log("ðŸ“¥ newDeposit:", newOnes);
      const current = Array.from(document.getElementsByClassName("entry")).map(div => div.textContent);
      render([...newOnes, ...current]);
    });
  </script>
</body>
</html>
